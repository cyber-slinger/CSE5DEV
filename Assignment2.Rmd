---
title: "CSE5DEV - Assignment 2"
output: html_document
date: "2024-09-07"
---
Student ID  : 22114129 <br>
Student Name: Sandip Subedi

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Get your current working directory in R using **getwd ()** function

```{r}
dir=getwd()
```

Set your working  directory in R using **setwd ()** function


```{r}
setwd(dir)
```

```{r}
#DO NOT CHANGE THE CODE BELOW!
word_count <- function(s)
  {
    return(length(strsplit(str, "\\s+")[[1]]))
  }
```

## Task 1
[ChatGPT url](https://chatgpt.com/share/xxxxxxxx)


**Without the valid link, your Task1 will be marked <50%**

Task 1.a <br>
![Image Caption](task1_df.png)
```{r}
#Put your R code to produce the correct dataframe here

# load CSV into  data frame
df <- read.csv("Studentmarks.csv")

# Checking the structure of the dataframe df
str(df)

# Converting the dob column into a date object
df$dob <- as.Date(df$dob, format = "%d/%m/%Y")  # Adjust the format as needed

# Checking the structure of the dataframe again to confirm the conversion
str(df)

# Calculate the current age from the dob column and store it in a new column 'age1'
df$age1 <- round(as.numeric(difftime(Sys.Date(), df$dob, units = "days")) / 365.25, 5)

# View the updated dataframe
head(df)

# Extract day, month, and year from the dob column into separate columns
df$day <- as.integer(format(df$dob, "%d"))  # Extract day
df$month <- as.integer(format(df$dob, "%m"))  # Extract month
df$year <- as.integer(format(df$dob, "%Y"))  # Extract year

# View the updated dataframe
head(df)

#Extracting the current year 
current_year <- as.integer(format(Sys.Date(), "%Y"))

#Calculate age using year only and store it in a new column 'age2'
df$age2 <- current_year - df$year

#updated dataframe
print(df)

#drop dob column
df$dob <- NULL

#view updated df
print(df)

#change name of column 'day'to 'date'
colnames(df)[which(names(df) == "day")] <- "date"

#view updated df
print(df)

#reorder the columns
df <- df[, c("StudentID","Studentname","date","month","year","X2020","X2021","X2022","age1","age2")]

#view updated df
print(df)

#
```

```{r}
#Use your own words to explain how the code works.
str<-"Your logical Explanation for 1.a"
print(paste("Word Count: ",word_count(str)))
```

Task 1.b
![Image Caption](task1b.png)
```{r}
#Put your R code to produce the correct chart here
# Load ggplot2 library
library(ggplot2)

# Create scatter plot with labels and color legend title
ggplot(df) +
  geom_point(aes(x = X2020, y = Studentname, color = "X2020")) +
  geom_point(aes(x = X2021, y = Studentname, color = "X2021")) +
  geom_point(aes(x = X2022, y = Studentname, color = "X2022")) +
  labs(x = "Marks", y = "Studentname", color = "Year")

```

```{r}
#Use your own words to explain how the code works.
str<-"Your logical Explanation for 1.b"
print(paste("Word Count: ",word_count(str)))
```

Task 1.c
![Image Caption](task1c.png)
```{r}
#Put your R code to produce the correct chart here
# Load necessary libraries
library(dplyr)
library(ggplot2)

df %>%
  mutate(total_marks = X2020 + X2021 + X2022) %>%
  filter(total_marks >= 200) %>%
  ggplot(aes(x = reorder(Studentname, -total_marks), y = total_marks)) +
  geom_bar(stat = "identity") +
  labs(x = "Students Name", y = "Total Marks", title = "Total Marks of Students (>=200) - Descending Order")


```

```{r}
#Use your own words to explain how the code works.
str<-"Your logical Explanation for 1.c"
print(paste("Word Count: ",word_count(str)))
```

## Task 2

Task 2.a
```{r}
#Put your Code here

#loading dirty_iris.csv data
dirty_iris <- read.csv("dirty_iris.csv", header=TRUE)
dirty_iris

#gives the dimension of the dataset
dim(dirty_iris)

```
```{r}
#Print  Missing Values details
sapply(dirty_iris, function(x) sum(is.na(x)))
```



```{r}
# sapply() applies the sum function to each column in the dataframe to count empty strings
empty_strings <- sapply(dirty_iris, function(x) sum(x == "", na.rm = TRUE))
empty_strings
```

```{r}
# Replacing all empty strings in the Species column with NA
dirty_iris$Species[dirty_iris$Species == ""] <- NA

#Checking again if empty strings exists or not
sum(dirty_iris$Species== "", na.rm=TRUE)

#Checking number of NAs again
sapply(dirty_iris, function(x) sum(is.na(x)))

#displaying data types of the columns
sapply(dirty_iris, class)
```
```{r}
#Finding the indices of missing values(NA) in Petal.Length and Species feature
ind1 <- which(is.na(dirty_iris$Petal.Length))
ind1
ind2 <- which(is.na(dirty_iris$Species)) 
ind2

```
```{r}
#Displays the full rows of missing values(NA) from Petal.length

ind1
dirty_iris[ind1, ]

#Excluding specific rows (ind1) from the dirty_iris to display a cleaned dataset only
dirty_iris[-ind1, ]

#Displays the full rows of missing values(NA) from Species column
ind2
dirty_iris[ind2, ]

# Excluding specific rows (ind2) from the dirty_iris to display a cleaned dataset only
dirty_iris[-ind2, ]
```
```{r}
#Displaying statistical information about the dataset
summary(dirty_iris)
```
```{r}
# colMeans() function returns the ratio of NAs for each column
print(colMeans(is.na(dirty_iris))*100 )

```
```{r}
# Create a new dataset that identifies whether values are missing (TRUE/FALSE)
missing_data <- dirty_iris %>%
  mutate_all(~ ifelse(is.na(.), "Missing", "Not Missing")) %>%
  gather(key = "Feature", value = "MissingStatus")

# View the transformed data
head(missing_data)



```
```{r}
# Create a bar plot to show the distribution of missing vs. not missing values per feature
ggplot(missing_data, aes(x = Feature, fill = MissingStatus)) +
  geom_bar() +
  labs(title = "Missing vs Non-Missing Values by Feature",
       x = "Features",
       y = "Count",
       fill = "Missing Status") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```
```{r}
# Load ggplot2 package if not already
library(ggplot2)

# Create a histogram with density plot
ggplot(dirty_iris, aes(x = Petal.Length)) +
  geom_histogram(aes(y = ..density..), bins = 20, fill = "lightblue", color = "black") +
  geom_density(color = "red", size = 1) +
  labs(title = "Histogram and Density Plot ",
       x = "Petal.Length",
       y = "Density") +
  theme_minimal()

```
```{r}
write.csv(dirty_iris, "dirty_iris_miss.csv", row.names = FALSE)
```

```{r}
#Put your explanation here
str<-"Your logical Explanation for 2.a"
print(paste("Word Count: ",word_count(str)))
```

Task 2.b

```{r}
#Put your Code here

dat <- read.csv("dirty_iris_miss.csv")

#Replace Missing vlauses in Sepal.Length by median value
#ind1 is the indices of missing values of Petal.length
media<- median(dat$Petal.Length[-ind1])
print(paste("median:",media))
dat$Petal.Length[ind1] <- media
dat[ind1, ]
```

```{r}
# Statistical summary for clean data and imputed data
dirty_summary <- summary(dirty_iris$Petal.Length)
imputed_summary <- summary(dat$Petal.Length)

# Standard deviation and Variance
dirty_sd <- sd(dirty_iris$Petal.Length,na.rm = TRUE)
dirty_var <- var(dirty_iris$Petal.Length,na.rm = TRUE)
imputed_sd <- sd(dat$Petal.Length)
imputed_var <- var(dat$Petal.Length)

# Display statistical summary of clean and imputed data
print("Statistical info of Petal.Length")
cat("Dirty dataset summary:\n")
print(dirty_summary)
cat("Imputed summary:\n")
print(imputed_summary)

# Display sd and variances
print(paste("Dirty Data SD:", dirty_sd))
print(paste("Imputed Data SD:", imputed_sd))
print(paste("Dirty Data Variance:", dirty_var))
print(paste("Imputed Data Variance:", imputed_var))



```

```{r}
#Histogram: Petal.Length
#Mean of Petal.length of both datasets
mean_dirty<- mean(dirty_iris$Petal.Length, na.rm = TRUE)
mean_dat <- mean(dat$Petal.Length, na.rm = TRUE)


#Histogram to compare Petal.length in both datasets with mean lines
ggplot() +
  geom_histogram(data = dirty_iris, aes(x = Petal.Length, fill = "Dirty"), 
                 bins = 20, alpha = 0.9) +
  geom_histogram(data = dat, aes(x = Petal.Length, fill = "Imputed"), 
                 bins = 20, alpha = 0.3) +
  geom_vline(aes(xintercept = mean_dirty, color = "Dirty"), 
             linetype = "dashed", size = 1) +
  geom_vline(aes(xintercept = mean_dat, color = "Imputed"), 
             linetype = "dashed", size = 1) +
  labs(title = "Comparison of Petal Length",
       x = "Petal Length",
       y = "Frequency") +
  scale_fill_manual(name = "Dataset", values = c("Dirty" = "grey", "Imputed" = "lightblue")) +
  scale_color_manual(name = "Mean", values = c("Dirty" = "blue", "Imputed" = "orange")) +
  theme_minimal()
```
```{r}
#Boxplot:Petal.length

#Combine datasets for comparisiom
dirty_iris$Dataset <- "Dirty"
dat$Dataset <- "Imputed"
combined_data <- rbind(dirty_iris, dat)

#Creating a box plot to compare Petal.length in both datasetsa
ggplot(combined_data, aes(x = Dataset, y = Petal.Length, fill = Dataset)) +
  geom_boxplot(alpha = 0.6) + 
  labs(title = "Comparison of Petal Length",
       x = "Dataset",
       y = "Petal Length") +
  scale_fill_manual(values = c("Dirty" = "grey", "Imputed" = "lightblue")) +
  theme_minimal()

```


```{r}
#Put your explanation here for 2.b
str<-"Your logical Explanation"
print(paste("Word Count: ",word_count(str)))
```

Task 2.c
```{r}
#Put your Code here

##  Replace Missing vlauses in  Species by median value



ind <- which(is.na(dat$Species))
ind
kk<-as.numeric(dat$Species[-ind])

kk
mod<- mode(dat$Species[-ind])



dat$Species[ind] <- mod



```

```{r}
#Put your explanation here for 2.c
str<-"Your logical Explanation for 2.c"
print(paste("Word Count: ",word_count(str)))
```

Task 2.d
```{r}
#Put your Code here


```

```{r}
#Put your explanation here for 2.d
str<-"Your logical Explanation for 2.d"
print(paste("Word Count: ",word_count(str)))
```

```{r}
sign <- TRUE
print(paste("I confirm that the work submitted is my own and has been completed without assistance or collaboration with others. I understand that submitting work that is not my own may result in academic misconduct.",sign))
```

